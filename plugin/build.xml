<project name="MosaicToolbox" default="" basedir=".">
    <description>
    	IAPMosaic_.jar build file
    </description>
  <property name="src" location="src" />
  <property name="build" location="bin" />
  <property name="dist"  location="dist" />
	<property name="lib" value="lib"/>
	 <property name="pluginsDir"  location="../../../imageJ/ImageJ_1.45/ImageJ/plugins/Mosaic_Toolbox" />
<property name="jarfilename" value="MosaicToolbox_" />
  <property name="user.name" value="Arun Shivanandan" />
<target name="main" depends="clean,build,compress,compressLibs" description="Main target">
	<echo>
		Building the .jar file.
	</echo>
</target>
 <target name="compress" depends="" description="generate the distribution">
 	<jar jarfile="MosaicToolbox_.jar">
		<fileset dir="${build}" includes="**/*.*" />
 		<fileset dir="." includes="macros/*.ijm" />
 		<fileset dir="." includes="plugins.config" />
 		<manifest>	
 		 	 	      <attribute name="Built-By" value="${user.name}"/>
 		</manifest> 
 	</jar>
    <copy file="MosaicToolbox_.jar" toDir="${pluginsDir}" />
  </target>
	
	<target name="clean" description="deletes all binaries and jars">
			<echo>
				Deleting files...
			</echo>
			<delete>
				<fileset dir="${pluginsDir}" includes="${jarfilename}.jar" />
			</delete>
			<delete>
				<fileset dir="${build}" includes="*.class" />
			</delete>
			<echo>
				... done.
			</echo>
	</target>
	
  <path id="build.classpath">
    <fileset dir="lib/">
      <include name="ij.jar"/>
    </fileset>
    
    <!--	<fileset dir="/Users/arun/Documents/Programs_APIs">
	<include name="junit-3.8.1.jar"/>
	
	<include name="jfreechart-1.0.13.jar"/>
	
	</fileset>
	
    -->
    
    <pathelement location="${build}"/>
    
    <pathelement path="lib"/>
    
    <!-- classpath Scalala -->
    <!-- <pathelement location="../Scalala/target/scala-2.9.2/classes"/> -->
    <fileset dir="lib/">
      <include name="*.jar"/>
    </fileset>
    
    
  </path>
	
	<target name="build">
	    
	    <javac srcdir="src/" debug="true"  destdir="bin/" classpathref="build.classpath"
	           classpath="${build.classpath}"/>
	</target>
	
	<target name="compressLibs" depends="compress" description="generate the distribution with all libs">
				<echo>
					Adding all libs to the .jar.
				</echo>
			 	<jar jarfile="${pluginsDir}/${jarfilename}.jar" update="true">
			 		
			 		<zipgroupfileset dir="${lib}" includes="*.jar"/>
			 		
		
			 		<manifest>
			 			<attribute name="Built-By" value="${user.name}"/>
			 		</manifest>
			 	</jar>
			</target>
</project>
